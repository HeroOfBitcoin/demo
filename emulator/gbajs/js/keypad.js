class GameBoyAdvanceKeypad{constructor(){this.KEYCODE_LEFT=37,this.KEYCODE_UP=38,this.KEYCODE_RIGHT=39,this.KEYCODE_DOWN=40,this.KEYCODE_START=13,this.KEYCODE_SELECT=220,this.KEYCODE_A=90,this.KEYCODE_B=88,this.KEYCODE_L=65,this.KEYCODE_R=83,this.GAMEPAD_LEFT=14,this.GAMEPAD_UP=12,this.GAMEPAD_RIGHT=15,this.GAMEPAD_DOWN=13,this.GAMEPAD_START=9,this.GAMEPAD_SELECT=8,this.GAMEPAD_A=1,this.GAMEPAD_B=0,this.GAMEPAD_L=4,this.GAMEPAD_R=5,this.GAMEPAD_THRESHOLD=.2,this.keymodalactive=!1,this.A=0,this.B=1,this.SELECT=2,this.START=3,this.RIGHT=4,this.LEFT=5,this.UP=6,this.DOWN=7,this.R=8,this.L=9,this.currentDown=1023,this.eatInput=!1,this.gamepads=[],this.remappingKeyId=''}keyboardHandler(b){if(this.keymodalactive)return;var a=0;if(this.remappingKeyId!=''){this.remapKeycode(this.remappingKeyId,b.keyCode),this.remappingKeyId='',b.preventDefault();return}switch(b.keyCode){case this.KEYCODE_START:a=this.START;break;case this.KEYCODE_SELECT:a=this.SELECT;break;case this.KEYCODE_A:a=this.A;break;case this.KEYCODE_B:a=this.B;break;case this.KEYCODE_L:a=this.L;break;case this.KEYCODE_R:a=this.R;break;case this.KEYCODE_UP:a=this.UP;break;case this.KEYCODE_RIGHT:a=this.RIGHT;break;case this.KEYCODE_DOWN:a=this.DOWN;break;case this.KEYCODE_LEFT:a=this.LEFT;break;default:return}a=1<<a,b.type=='keydown'?this.currentDown&=~a:this.currentDown|=a,this.eatInput&&b.preventDefault()}gamepadHandler(b){var a=0;b.buttons[this.GAMEPAD_LEFT]>this.GAMEPAD_THRESHOLD&&(a|=1<<this.LEFT),b.buttons[this.GAMEPAD_UP]>this.GAMEPAD_THRESHOLD&&(a|=1<<this.UP),b.buttons[this.GAMEPAD_RIGHT]>this.GAMEPAD_THRESHOLD&&(a|=1<<this.RIGHT),b.buttons[this.GAMEPAD_DOWN]>this.GAMEPAD_THRESHOLD&&(a|=1<<this.DOWN),b.buttons[this.GAMEPAD_START]>this.GAMEPAD_THRESHOLD&&(a|=1<<this.START),b.buttons[this.GAMEPAD_SELECT]>this.GAMEPAD_THRESHOLD&&(a|=1<<this.SELECT),b.buttons[this.GAMEPAD_A]>this.GAMEPAD_THRESHOLD&&(a|=1<<this.A),b.buttons[this.GAMEPAD_B]>this.GAMEPAD_THRESHOLD&&(a|=1<<this.B),b.buttons[this.GAMEPAD_L]>this.GAMEPAD_THRESHOLD&&(a|=1<<this.L),b.buttons[this.GAMEPAD_R]>this.GAMEPAD_THRESHOLD&&(a|=1<<this.R),this.currentDown=~a&1023}gamepadConnectHandler(a){this.gamepads.push(a)}gamepadDisconnectHandler(a){this.gamepads=self.gamepads.filter(function(b){return b!=a})}pollGamepads(){var a=[],b;navigator.webkitGetGamepads?a=navigator.webkitGetGamepads():navigator.getGamepads&&(a=navigator.getGamepads()),a.length&&(this.gamepads=[]);for(b=0;b<a.length;++b)a[b]&&this.gamepads.push(a[b]);this.gamepads.length>0&&this.gamepadHandler(this.gamepads[0])}registerHandlers(){window.addEventListener('keydown',this.keyboardHandler.bind(this),!0),window.addEventListener('keyup',this.keyboardHandler.bind(this),!0),window.addEventListener('gamepadconnected',this.gamepadConnectHandler.bind(this),!0),window.addEventListener('mozgamepadconnected',this.gamepadConnectHandler.bind(this),!0),window.addEventListener('webkitgamepadconnected',this.gamepadConnectHandler.bind(this),!0),window.addEventListener('gamepaddisconnected',this.gamepadDisconnectHandler.bind(this),!0),window.addEventListener('mozgamepaddisconnected',this.gamepadDisconnectHandler.bind(this),!0),window.addEventListener('webkitgamepaddisconnected',this.gamepadDisconnectHandler.bind(this),!0)}initKeycodeRemap(a){var b=['A','B','SELECT','START','RIGHT','LEFT','UP','DOWN','R','L'];b.indexOf(a)!=-1&&(this.remappingKeyId=a)}remapKeycode(b,a){switch(b){case'A':this.KEYCODE_A=a;break;case'B':this.KEYCODE_B=a;break;case'SELECT':this.KEYCODE_SELECT=a;break;case'START':this.KEYCODE_START=a;break;case'RIGHT':this.KEYCODE_RIGHT=a;break;case'LEFT':this.KEYCODE_LEFT=a;break;case'UP':this.KEYCODE_UP=a;break;case'DOWN':this.KEYCODE_DOWN=a;break;case'R':this.KEYCODE_R=a;break;case'L':this.KEYCODE_L=a;break}}getKeyCodeValue(b){var a=-1;switch(b){case'A':a=this.KEYCODE_A;break;case'B':a=this.KEYCODE_B;break;case'SELECT':a=this.KEYCODE_SELECT;break;case'START':a=this.KEYCODE_START;break;case'RIGHT':a=this.KEYCODE_RIGHT;break;case'LEFT':a=this.KEYCODE_LEFT;break;case'UP':a=this.KEYCODE_UP;break;case'DOWN':a=this.KEYCODE_DOWN;break;case'R':a=this.KEYCODE_R;break;case'L':a=this.KEYCODE_L;break}return a}}